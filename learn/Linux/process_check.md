# 운영체제 프로세스 메모리 할당과 동작 방식 (리눅스 기준)
    
리눅스는 프로세스의 메모리 관리는 가상 메모리와 페이징을 기반으로 이루진다고 한다. 코드(Text), 데이터, 힙, 스택 등 다양한 메모리 영역으로 나누어 관리된다. 동시에 동적 메모리 할당, 메모리 매핑, 페이지 테이블, TLB, 스와핑 등 다양한 기법이 사용되어 메모리 사용의 효율성과 안정성을 높이고 있다.

---

### 1. 프로세스 메모리 구조

리눅스 운영체제에서 프로세스는 다음과 같은 메모리 영역으로 나누어진다:

1. **코드 영역 (Text Segment)**:
- 실행 파일의 코드가 저장되는 영역.
- 실행 가능한 명령어들이 포함.
- 일반적으로 읽기 전용이며, 공유 가능하게 설정될 수 있다.
2. **데이터 영역 (Data Segment)**:
- 전역 변수와 정적 변수가 저장되는 영역.
- 초기화된 데이터와 초기화되지 않은 데이터로 구분.
    - 초기화된 데이터는 프로그램 시작 시 초기값이 할당된 변수.
    - 초기화되지 않은 데이터(BSS - Block Started by Symbol)는 프로그램 시작 시 0으로 초기화되는 변수들.
3. **힙 영역 (Heap)**:
- 동적으로 메모리를 할당받을 때 사용되는 영역.
- `malloc`, `calloc`, `realloc` 등의 함수로 메모리를 할당하고, `free` 함수로 해제.
- 프로그램 실행 중에 크기가 동적으로 변경될 수 있다.
4. **스택 영역 (Stack)**:
- 함수 호출과 관련된 지역 변수와 매개 변수가 저장되는 영역.
- 함수 호출 시마다 새로운 스택 프레임이 할당되며, 함수 종료 시 스택 프레임이 해제된.
- LIFO(Last In First Out) 방식으로 동작한다.
5. **메모리 매핑 영역 (Memory Mapped Segment)**:
- 공유 라이브러리와 파일 매핑에 사용되는 영역.
- `mmap` 시스템 호출을 통해 메모리 매핑이 이루어진다.

### 2. 프로세스 메모리 할당 방식

리눅스 운영체제는 다음과 같은 방식으로 프로세스에 메모리를 할당된다:

6. **가상 메모리 (Virtual Memory)**:
- 각 프로세스는 독립된 가상 메모리 공간을 갖는다.
- 가상 메모리는 실제 물리 메모리와 일대일 대응되지 않으며, 페이지 테이블을 통해 물리 메모리와 매핑된다.
- 가상 메모리를 통해 메모리 보호와 메모리 공간 확장이 가능하다.
7. **페이징 (Paging)**:
- 메모리를 고정 크기 블록(페이지)으로 나누어 관리.
- 가상 메모리 주소를 페이지 단위로 물리 메모리와 매핑하여 사용된다.
- 페이지 부재(Page Fault) 시 필요한 페이지를 디스크에서 메모리로 가져옴.
8. **메모리 매핑 (Memory Mapping)**:
- 파일이나 장치를 메모리에 매핑하여 사용됨.
- `mmap` 시스템 호출을 통해 파일을 메모리에 매핑하면, 파일의 내용이 메모리 주소 공간에 직접 대응한다.
9. **동적 메모리 할당 (Dynamic Memory Allocation)**:
- 프로세스 실행 중 필요에 따라 동적으로 메모리를 할당하고 해제.
- 힙 영역을 사용하여 동적 메모리를 관리.
- 메모리 단편화(Memory Fragmentation)를 방지하기 위해 다양한 메모리 할당 알고리즘이 사용된다.

### 3. 프로세스 메모리 관리

리눅스 운영체제는 다음과 같은 메모리 관리 기법을 사용:

10. **페이지 테이블 (Page Table)**:
- 가상 주소와 물리 주소 간의 매핑 정보를 저장.
- 각 프로세스마다 독립된 페이지 테이블이 존재.
11. **TLB (Translation Lookaside Buffer)**:
- 최근에 사용된 페이지 테이블 항목을 캐싱하여 주소 변환 속도를 향상시킴.
- 페이지 테이블 조회를 줄이기 위해 사용됨.
12. **스와핑 (Swapping)**:
- 메모리가 부족할 때, 사용하지 않는 페이지를 디스크로 내보내고 필요한 페이지를 메모리로 불러온다.
- 스와핑을 통해 효율적인 메모리 사용이 가능하다.
13. **커널 메모리 관리 (Kernel Memory Management)**:
- 커널은 다양한 자료 구조와 알고리즘을 사용하여 메모리를 효율적으로 관리.
- Slab Allocator, Buddy System 등이 사용된다.